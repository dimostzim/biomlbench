# CLI Reference

BioML-bench's command-line interface for managing biomedical benchmark tasks and running agent evaluations.

::: biomlbench.cli
    options:
      show_source: false
      heading_level: 2

## Main Help

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

## Commands

### `biomlbench prepare`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

### `biomlbench run-agent`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

### `biomlbench grade`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

### `biomlbench grade-sample`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

### `biomlbench run-baseline`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

### `biomlbench dev`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

#### `biomlbench dev download-leaderboard`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

#### `biomlbench dev prepare-human-baselines`

```
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/cli.py", line 8, in <module>
    from biomlbench.agents import run_agent
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/agents.py", line 24, in <module>
    from biomlbench.data import is_dataset_prepared
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data.py", line 22, in <module>
    from biomlbench.data_sources import DataSourceError, DataSourceFactory
  File "/home/paperspace/biomlbenchpub/biomlbench/biomlbench/data_sources/__init__.py", line 17, in <module>
    from .openproblems import OpenProblemsDataSource
ModuleNotFoundError: No module named 'biomlbench.data_sources.openproblems'

```

## Usage Examples

### Task Preparation

```bash
# Prepare a specific task
biomlbench prepare -t polarishub/tdcommons-caco2-wang

# Prepare all tasks in a domain
biomlbench prepare --domain admet

# Prepare multiple tasks from a file
biomlbench prepare --list experiments/splits/caco2-wang.txt

# Prepare all low-difficulty tasks
biomlbench prepare --lite
```

### Agent Execution

```bash
# Run agent on single task
biomlbench run-agent --agent dummy --task-id polarishub/tdcommons-caco2-wang

# Run agent on multiple tasks with parallel workers
biomlbench run-agent \
    --agent aide \
    --task-list experiments/splits/caco2-wang.txt \
    --n-workers 4 \
    --n-seeds 3

# Run with custom container configuration
biomlbench run-agent \
    --agent aide \
    --task-id polarishub/tdcommons-caco2-wang \
    --container-config custom_config.json \
    --retain-container
```

### Evaluation and Grading

```bash
# Grade multiple task submissions
biomlbench grade \
    --submission runs/my-run-group/submission.jsonl \
    --output-dir results/

# Grade single task submission (CSV format)
biomlbench grade-sample submission.csv polarishub/tdcommons-caco2-wang

# Grade single task submission (H5AD format)
biomlbench grade-sample submission.h5ad openproblems/cell_cell_communication

# Run and grade baselines
biomlbench run-baseline polarishub/tdcommons-caco2-wang --baseline all
biomlbench grade \
    --submission baseline_submissions/submission.jsonl \
    --output-dir baseline_results/
```

### Development Commands

```bash
# Download leaderboards for all tasks
biomlbench dev download-leaderboard --all

# Prepare human baselines for a specific task
biomlbench dev prepare-human-baselines -t polarishub/tdcommons-caco2-wang --force
```

## Environment Variables

BioML-bench respects these environment variables:

### Agent Configuration  
- **`OPENAI_API_KEY`** - API key for AIDE agent
- **`I_ACCEPT_RUNNING_PRIVILEGED_CONTAINERS`** - Set to "true" to allow privileged containers

### Kaggle Integration
Kaggle authentication uses the standard configuration file at `~/.kaggle/kaggle.json`. See the [Kaggle API documentation](https://github.com/Kaggle/kaggle-api) for setup instructions.

## Common Patterns

### Full Workflow Example

```bash
# 1. Prepare tasks
biomlbench prepare --lite

# 2. Run agent
biomlbench run-agent --agent dummy --task-list experiments/splits/polarishub-tdcommons-caco2-wang.txt

# 3. Grade results (submission.jsonl is auto-generated)
biomlbench grade \
    --submission runs/latest-run-group/submission.jsonl \
    --output-dir results/
```

### Debugging Agent Issues

```bash
# Run with container retention for debugging
biomlbench run-agent \
    --agent my-agent \
    --task-id polarishub/tdcommons-caco2-wang \
    --retain-container

# Check logs in the run directory
ls runs/latest-run-group/*/logs/
```
